## [Back](https://github.com/ifanzilka/Statistic_for_R/blob/main/Module%202:%20advanced%20structures/module2.md)


## Строки

Строка (string) – это элемент вектора типа character

Большинство функций, оперирующих на строках, векторизованы

    s <- c("Терпение и труд всё перетрут", 
           "Кончил дело — гуляй смело", 
           "Без труда не вытащишь и рыбку из пруда",
           'Работа не волк, в лес не убежит')

Как правило, для строк используют двойные кавычки

Одинарные кавычки тоже можно использовать: 'Операция "Ы"'

    
    ## [1] "Операция \"Ы\""


## Функции paste/paste0

Выполняют конкатенацию строковых векторов с учётом правил переписывания

Аргумент sep – разделитель между элементами (для paste по умолчанию пробел, для paste0 – пустая строка)

Аргумент collapse – “схлопывает” вектор в одну строку

    paste(c("углекислый", "веселящий"), "газ")
#

    ## [1] "углекислый газ" "веселящий газ"
OR
    
    paste(c("углекислый", "веселящий"), "газ", sep = "_")
#
    ## [1] "углекислый_газ" "веселящий_газ"
OR

    paste(c("углекислый", "веселящий"), "газ", collapse = ", а также ")
#
    ## [1] "углекислый газ, а также веселящий газ"




## Функция strsplit

Выполняет разбиение строкового вектора

Результат – список!

    strsplit(s, " и ", fixed = TRUE)
#
    ## [[1]]
    ## [1] "Терпение"          "труд всё перетрут"
    ## 
    ## [[2]]
    ## [1] "Кончил дело — гуляй смело"
    ## 
    ## [[3]]
    ## [1] "Без труда не вытащишь" "рыбку из пруда"       
    ## 
    ## [[4]]
    ## [1] "Работа не волк, в лес не убежит"
    


## Функция strsplit


Если не указывать аргумент fixed (по умолчанию FALSE), то строка, по которой проводится разбиение, будет рассматриваться как регулярное выражение:

В данном примере разделение по всем знакам препинания

    strsplit(s, "[[:punct:]]")
#
    ## [[1]]
    ## [1] "Терпение и труд всё перетрут"
    ## 
    ## [[2]]
    ## [1] "Кончил дело " " гуляй смело"
    ## 
    ## [[3]]
    ## [1] "Без труда не вытащишь и рыбку из пруда"
    ## 
    ## [[4]]
    ## [1] "Работа не волк"   " в лес не убежит"



## Регулярные выражения

“Метаязык” поиска и манипуляции подстрок
 
 Образец для поиска может включать обычные символы и т.н. wildcards

grep скажет в какие строках есть слово

    grep("труд", s)
#
    ## [1] 1 3
OR
    
    grepl("труд", s)
#
    ## [1]  TRUE FALSE  TRUE FALSE
OR (Замена) Всел слова из 4-5 букв
    
    gsub("\\b[[:alpha:]]{4,5}\\b", "####",  s)
#
    ## [1] "Терпение и #### всё перетрут"        "Кончил #### — #### ####"            
    ## [3] "Без #### не вытащишь и #### из ####" "Работа не ####, в лес не убежит"



## Пакет stringr

    #install.packages("stringr")
    library(stringr)

Пакет содержит множество функций для работы со строками. Эти функции векторизованы и являются consistent:

поиск по шаблону

    str_extract(s, "н.")
#
    ## [1] "ни" "нч" "не" "не"
OR (Поиск по шаблону и замнена)
    
    str_replace(s, "[иа]", "?")
#
    ## [1] "Терпен?е и труд всё перетрут"           "Конч?л дело — гуляй смело"             
    ## [3] "Без труд? не вытащишь и рыбку из пруда" "Р?бота не волк, в лес не убежит"




## Пакет stringr

Ко многим функциям можно добавить _all, чтобы искать все вхождения, а не первое:

    str_extract_all(s, "н.")

    ## [[1]]
    ## [1] "ни"
    ## 
    ## [[2]]
    ## [1] "нч"
    ## 
    ## [[3]]
    ## [1] "не"
    ## 
    ## [[4]]
    ## [1] "не" "не"
#
    str_replace_all(s, "[иае]", "?")
#
    ## [1] "Т?рп?н?? ? труд всё п?р?трут"           "Конч?л д?ло — гуляй см?ло"             
    ## [3] "Б?з труд? н? выт?щ?шь ? рыбку ?з пруд?" "Р?бот? н? волк, в л?с н? уб?ж?т"



## Функции tolower/toupper

Манипулирование регистром:

    tolower(month.name)
#
    ##  [1] "january"   "february"  "march"     "april"     "may"       "june"      "july"      "august"   
    ##  [9] "september" "october"   "november"  "december"
OR

    toupper(month.abb)
#
    ##  [1] "JAN" "FEB" "MAR" "APR" "MAY" "JUN" "JUL" "AUG" "SEP" "OCT" "NOV" "DEC"



